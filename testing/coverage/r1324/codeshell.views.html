<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>code coverage of views.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">

<style type="text/css">
pre.code {
    font-style: Lucida,"Courier New";
}
.number {
    color: #0080C0;
}
.operator {
    color: #000000;
}
.string {
    color: #008000;
}
.comment {
    color: #808080;
}
.name {
    color: #000000;
}
.error {
    color: #FF8080;
    border: solid 1.5pt #FF0000;
}
.keyword {
    color: #0000FF;
    font-weight: bold;
}
.text {
    color: #000000;
}
.notcovered {
    background-color: #FFB2B2;
}
</style>

</head>
<body>
<pre class="code">
<span class="string">'''

@author Mark Gius
@author James Pearson
'''</span><span class="text">
</span><span class="keyword">from</span> <span class="name">django</span><span class="operator">.</span><span class="name">utils</span> <span class="keyword">import</span> <span class="name">simplejson</span><span class="text">
</span><span class="keyword">from</span> <span class="name">django</span><span class="operator">.</span><span class="name">http</span> <span class="keyword">import</span> <span class="name">HttpResponse</span><span class="text">
</span><span class="keyword">from</span> <span class="name">codeshell</span><span class="operator">.</span><span class="name">pythoncode</span> <span class="keyword">import</span> <span class="name">evalPythonString</span><span class="text">
</span><span class="text">
</span><span class="keyword">def</span> <span class="name">execute</span><span class="operator">(</span><span class="name">request</span><span class="operator">)</span><span class="operator">:</span><span class="text">
</span>        <span class="string">'''
                Executes python code
        '''</span><span class="text">
</span><span class="notcovered">        <span class="keyword">try</span><span class="operator">:</span></span><span class="text">
</span><span class="notcovered">                <span class="name">result</span> <span class="operator">=</span> <span class="name">evalPythonString</span><span class="operator">(</span><span class="name">request</span><span class="operator">.</span><span class="name">GET</span><span class="operator">[</span><span class="string">'code'</span><span class="operator">]</span><span class="operator">)</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span></span><span class="text">
</span><span class="notcovered">        <span class="keyword">except</span> <span class="name">SyntaxError</span><span class="operator">,</span> <span class="name">e</span><span class="operator">:</span></span><span class="text">
</span><span class="notcovered">                <span class="name">result</span> <span class="operator">=</span> <span class="name">str</span><span class="operator">(</span><span class="name">e</span><span class="operator">)</span></span><span class="text">
</span><span class="notcovered">        <span class="comment"># so... there are some things that we currently aren't dealing with,
</span>        <span class="comment"># as far as handlers for things in RestrictedPython
</span>        <span class="comment"># better not send a 500, as that'll just produce no result
</span>        <span class="keyword">except</span> <span class="name">Exception</span><span class="operator">,</span> <span class="name">e</span><span class="operator">:</span></span><span class="text">
</span><span class="notcovered">                <span class="comment">#import pdb; pdb.set_trace()
</span>                <span class="name">result</span> <span class="operator">=</span> <span class="string">"Oops!  We weren't able to process your request, so please let your instructor know so we can fix it, mmk?"</span></span><span class="text">
</span><span class="notcovered">        <span class="keyword">return</span> <span class="name">HttpResponse</span><span class="operator">(</span><span class="name">simplejson</span><span class="operator">.</span><span class="name">dumps</span><span class="operator">(</span><span class="operator">{</span><span class="string">'result'</span><span class="operator">:</span> <span class="name">result</span><span class="operator">}</span><span class="operator">)</span><span class="operator">,</span></span><span class="text">
</span>                            <span class="name">mimetype</span><span class="operator">=</span><span class="string">'application/json'</span><span class="operator">)</span><span class="text"></span>
</pre></body>
</html>
